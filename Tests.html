<!DOCTYPE html>
<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">

<style>
body {
padding-left: 15px;
}
.action {
margin-top: 10px;
}
.testInfoButton {
  display: none;
}
#tcVariables {
  display: none;
}
.toggleForm {
  display: none;
}
</style>

<html>
  <head>
    <base target="_top">
  </head>
  <body>
  <form id="generalInformation">
    <p>Select the desired test from the drop-down:</p>
    <select name="tests">
      <option value="chemicalExposure">Chemical Exposure</option>
      <option value="coldSoak">Cold Soak</option> 
      <option value="coldStorage">Cold Storage</option> 
      <option value="enduranceVibration">Endurance (Survivability) Vibration</option>
      <option value="functionalVibration">Functional (Operational) Vibration</option>
      <option value="hotSoak">Hot Soak</option> 
      <option value="hotStorage">Hot Storage</option> 
      <option value="istaDrop">ISTA Drop</option>
      <option value="thermalCycle">Thermal Cycle</option> 
      <option value="thermalShock">Thermal Shock</option> 
      <option value="transitDrop">Transit Drop</option>
   </select>
  </form>
    <input type="button" class="action" onclick="formSubmit()" value="Add test" />
<!--These are prompts for test specific information-->
  <form id="coldSoakVariables" class="toggleForm"> 
    <p>Tell me more about this cold soak test:</p>
    <p>What's the dwell temperature?</p>
    <input type="text" name="dwellTemp" value="">
    <p>How long is the dwell time in hours?</p>
    <input type="text" name="dwellTime" value="">
    <p>What's the minimum voltage?</p>
    <input type="text" name="minVoltage" value="">
    <p>What's the maximum voltage?</p>
    <input type="text" name="maxVoltage" value="">
    <input type="hidden" name="hiddenTestName" value = "1"/> <!--Since form.id only returns undefined in Code.js, this hidden input is how to tell what form we're in-->
  </form>
  <form id="hotSoakVariables" class="toggleForm"> 
    <p>Tell me more about this hot soak test:</p>
    <p>What's the dwell temperature?</p>
    <input type="text" name="dwellTemp" value="">
    <p>How long is the dwell time in hours?</p>
    <input type="text" name="dwellTime" value="">
    <p>What's the minimum voltage?</p>
    <input type="text" name="minVoltage" value="">
    <p>What's the maximum voltage?</p>
    <input type="text" name="maxVoltage" value="">
    <p>How long will it take in hours for the DUT to achieve steady state temperatures?</p>
    <input type="text" name="steadyTime" value="">
    <p>What's the voltage range?</p>
    <input type="text" name="voltageRange" value="">
    <input type="hidden" name="hiddenTestName" value = "2"/>
  </form>
  <form id="hotStorageVariables" class="toggleForm"> 
    <p>Tell me more about this hot storage test:</p>
    <p>What's the dwell temperature?</p>
    <input type="text" name="dwellTemp" value="">
    <p>How long is the dwell time in hours?</p>
    <input type="text" name="dwellTime" value="">
    <input type="hidden" name="hiddenTestName" value = "3"/>
  </form>
  <form id="coldStorageVariables" class="toggleForm"> 
    <p>Tell me more about this cold storage test:</p>
    <p>What's the dwell temperature?</p>
    <input type="text" name="dwellTemp" value="">
    <p>How long is the dwell time in hours?</p>
    <input type="text" name="dwellTime" value="">
    <input type="hidden" name="hiddenTestName" value = "4"/>
  </form>
  <form id="thermalCycleVariables" class="toggleForm">
    <p>Tell me more about this thermal cycling test:</p>
    <p>What's the minimum temperature?</p>
    <input type="text" name="minTemp" value="">
    <p>What's the maximum temperature?</p>
    <input type="text" name="maxTemp" value="">
    <p>How long is the dwell time in hours? (Look at the table in the overview.)</p>
    <input type="text" name="dwellTime" value="">
    <p>How many cycles are there?</p>
    <input type="text" name="cycles" value="">
    <input type="hidden" name="hiddenTestName" value = "5"/> 
  </form>
  <form id="thermalShockVariables" class="toggleForm">
    <p>Tell me more about this thermal shock test:</p>
    <p>What's the minimum temperature?</p>
    <input type="text" name="minTemp" value="">
    <p>What's the maximum temperature?</p>
    <input type="text" name="maxTemp" value="">
    <p>How long is the dwell time in hours?</p>
    <input type="text" name="dwellTime" value="">
    <p>How many shock events are there?</p>
    <input type="text" name="shockEvents" value="">
    <input type="hidden" name="hiddenTestName" value = "6"/> 
  </form>
  <form id="enduranceVibrationVariables" class="toggleForm"> <!--TO DO: Add bulleted list that insert the different profiles as images -->
    <p>Tell me more about this endurance (survivability) vibration test:</p>
    <p>What vibration profile do you want to use?</p>
    <select name="enduranceProfiles">
      <option value="1A">1A</option>
      <option value="1B">1B</option>
      <option value="2A">2A</option>
      <option value="2B">2B</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5A">5A</option>
      <option value="5B">5B</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8">8</option>
      <option value="9">9</option>
      <option value="10">10</option>
      <option value="11">11</option>
      <option value="12">12</option>
    </select>
    <input type="hidden" name="hiddenTestName" value = "7"/>
  </form>
  <input type="button" class="action testInfoButton" onclick="submitSpecificTestInformation()" value="Submit information for this test" /> 
  </body>
  
  <script type="text/javascript">
  function formSubmit()
  {
    var keepTrack = [];
    var selectedTest = document.forms[0].tests.value + "Variables"; // Tells us what test was selected from the drop-down.
    if (selectedTest != "chemicalExposureVariables" && selectedTest != "functionalVibrationVariables" && selectedTest != "istaDropVariables" && selectedTest != "transitDropVariables") // Avoids calling non-existent forms like "chemicalExposureVariables", which would throw an error.
    {
      document.getElementById(selectedTest).style.display = 'block';
      document.querySelector('.testInfoButton').style.display = 'block';
    }
    google.script.run.addNewTest(document.forms[0]);
    keepTrack += document.forms[0].tests.value;
    alert("So far you've selected the following tests:" + keepTrack);
  }

  function submitSpecificTestInformation()
  {
    var formNames = new Map([["coldSoakVariables", 1],["hotSoakVariables", 2],["hotStorageVariables", 3],
    ["coldStorageVariables", 4],["thermalCycleVariables", 5],["thermalShockVariables", 6],
    ["enduranceVibrationVariables", 7]]);

    var selectedTest = document.forms[0].tests.value + "Variables";
    var index = formNames.get(selectedTest);  // Looks up the test in the map to get the form index.
    var testNameAsString = document.forms[index].id;
    google.script.run.populateTestSpecificInformation(document.forms[index]) // A form goes in here.
    document.getElementById(selectedTest).style.display = 'none';
    document.querySelector('.testInfoButton').style.display = 'none';
  }
  </script>
</html>